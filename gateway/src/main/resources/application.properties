server.port=8080
spring.application.name=api-gateway

# Eureka discovery
eureka.client.service-url.defaultZone=http://localhost:8761/eureka/

# JWT usado para validação em AuthenticationFilter
jwt.secret=minha-chave-secreta-super-longa-e-dificil-de-adivinhar-para-o-petshop

# --- ROTAS PÚBLICAS ---

# Registro de clientes
spring.cloud.gateway.routes[0].id=conta-registro-route
spring.cloud.gateway.routes[0].uri=lb://conta-service
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/contas/clientes
spring.cloud.gateway.routes[0].predicates[1]=Method=POST

# Listagem de clientes
spring.cloud.gateway.routes[1].id=conta-listagem-route
spring.cloud.gateway.routes[1].uri=lb://conta-service
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/contas/clientes
spring.cloud.gateway.routes[1].predicates[1]=Method=GET

# Login
spring.cloud.gateway.routes[2].id=conta-login-route
spring.cloud.gateway.routes[2].uri=lb://conta-service
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/contas/auth/**

# --- ROTAS PROTEGIDAS ---

# Clientes e pets
spring.cloud.gateway.routes[3].id=conta-protected-route
spring.cloud.gateway.routes[3].uri=lb://conta-service
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/contas/clientes/**
spring.cloud.gateway.routes[3].predicates[1]=Path=/api/contas/pets/**
spring.cloud.gateway.routes[3].filters[0]=AuthenticationFilter

# Agendamento
spring.cloud.gateway.routes[4].id=agendamento-route
spring.cloud.gateway.routes[4].uri=lb://agendamento-service
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/agendamentos/**
spring.cloud.gateway.routes[4].filters[0]=AuthenticationFilter

# Pagamento
spring.cloud.gateway.routes[5].id=pagamento-route
spring.cloud.gateway.routes[5].uri=lb://pagamento-service
spring.cloud.gateway.routes[5].predicates[0]=Path=/api/pagamentos/**
spring.cloud.gateway.routes[5].filters[0]=AuthenticationFilter

# Vendas
spring.cloud.gateway.routes[6].id=vendas-route
spring.cloud.gateway.routes[6].uri=lb://vendas-service
spring.cloud.gateway.routes[6].predicates[0]=Path=/api/vendas/**
spring.cloud.gateway.routes[6].filters[0]=RewritePath=/api/vendas/(?<segment>.*), /${segment}
spring.cloud.gateway.routes[6].filters[1]=AddResponseHeader=Access-Control-Allow-Origin, http://localhost:5173
spring.cloud.gateway.routes[6].filters[2]=AddResponseHeader=Access-Control-Allow-Methods, GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.routes[6].filters[3]=AddResponseHeader=Access-Control-Allow-Headers, Authorization,Content-Type,Accept,X-User-ID
spring.cloud.gateway.routes[6].filters[4]=AddResponseHeader=Access-Control-Allow-Credentials, true
spring.cloud.gateway.routes[6].filters[5]=AddResponseHeader=Access-Control-Expose-Headers, Authorization
spring.cloud.gateway.routes[6].filters[6]=AuthenticationFilter

# --- Deleção de clientes por ID (Temporariamente pública para teste) ---
spring.cloud.gateway.routes[7].id=conta-delete-by-id-route
spring.cloud.gateway.routes[7].uri=lb://conta-service
spring.cloud.gateway.routes[7].predicates[0]=Path=/api/contas/clientes/{id}
spring.cloud.gateway.routes[7].predicates[1]=Method=DELETE
